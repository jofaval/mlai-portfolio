<?php

require_once 'require.php';

/**
 * The CLI given commands
 */
define('ARGS', $argv);

/**
 * Create a project
 * 
 * @param string $name
 * 
 * @return string
 */
function create_project(string $name)
{
    # code...
}

/**
 * Minimize a script
 * 
 * @param string $script
 * 
 * @return string
 */
function minimizeScript(string $script)
{
    # code...
}

/**
 * Minimize a style
 * 
 * @param string $style
 * 
 * @return string
 */
function minimizeStyle(string $style)
{
    # code...
}

function get_arg(int $index, $default = null)
{
    return isset(ARGS[$index]) ? ARGS[$index] : $default;
}

function get_action()
{
    // Take into account the CLI call in the args
    return get_arg(1);
}

$action = get_action();

// TODO: implement upload from cli
function deploy()
{
    $python_lib = 'python';
    $deploy_py_path = 'production/upload.py';

    // TODO: implement build here and not on upload, upload should only move the files
    // not handle the building process

    // Execute the command
    exec("$python_lib $deploy_py_path", $output);

    // Print response
    foreach ($output as $line) echo "$line\n";

    logging('deployed');
}

if (function_exists($action)) $action();